<!DOCTYPE html>
<html lang="en">
<head>
    <title>Schizo | Despair</title>
    <link rel="icon" href="/assets/despair.png"/>
    <meta property="og:title" content="Schizo | Despair"/>
    <meta property="og:description" content="Read about Despair."/>
    <meta property="og:image" content="https://schizophrenic.lol/assets/schizologo.png"/>
    <meta name="theme-color" content="#7700ff"/>
    <meta name="twitter:card" content="summary_large_image" />
    <link rel="stylesheet" href="/styles.css">
    <script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body>
    <div class="titlebar__bar">
        <div class="titlebar__logo">
            <a href="https://schizophrenic.lol">
                <img src="/assets/schizologo.png" alt="Logo">
            </a>
        </div>
    </div>

    <script>
        // Function to get browser information
        function getBrowserInfo() {
            const userAgent = navigator.userAgent || "Unknown";
            let browserName = navigator.appName || "Unknown";
            let fullVersion = '' + parseFloat(navigator.appVersion) || "Unknown";
            let nameOffset, verOffset;

            if ((verOffset = userAgent.indexOf("Opera")) != -1) {
                browserName = "Opera";
                fullVersion = userAgent.substring(verOffset + 6);
                if ((verOffset = userAgent.indexOf("Version")) != -1)
                    fullVersion = userAgent.substring(verOffset + 8);
            } else if ((verOffset = userAgent.indexOf("MSIE")) != -1) {
                browserName = "Microsoft Internet Explorer";
                fullVersion = userAgent.substring(verOffset + 5);
            } else if ((verOffset = userAgent.indexOf("Chrome")) != -1) {
                browserName = "Chrome";
                fullVersion = userAgent.substring(verOffset + 7);
            } else if ((verOffset = userAgent.indexOf("Safari")) != -1) {
                browserName = "Safari";
                fullVersion = userAgent.substring(verOffset + 7);
                if ((verOffset = userAgent.indexOf("Version")) != -1)
                    fullVersion = userAgent.substring(verOffset + 8);
            } else if ((verOffset = userAgent.indexOf("Firefox")) != -1) {
                browserName = "Firefox";
                fullVersion = userAgent.substring(verOffset + 8);
            } else if ((nameOffset = userAgent.lastIndexOf(' ') + 1) <
                (verOffset = userAgent.lastIndexOf('/'))) {
                browserName = userAgent.substring(nameOffset, verOffset);
                fullVersion = userAgent.substring(verOffset + 1);
                if (browserName.toLowerCase() == browserName.toUpperCase()) {
                    browserName = navigator.appName;
                }
            }

            return `${browserName} ${fullVersion}`;
        }

        // Function to get operating system information
        function getOSInfo() {
            const userAgent = navigator.userAgent || "Unknown";
            let os = "Unknown OS";

            if (userAgent.indexOf("Win") != -1) os = "Windows";
            if (userAgent.indexOf("Mac") != -1) os = "Macintosh";
            if (userAgent.indexOf("Linux") != -1) os = "Linux";
            if (userAgent.indexOf("Android") != -1) os = "Android";
            if (userAgent.indexOf("like Mac") != -1) os = "iOS";

            return os;
        }

        // Function to get network information
        function getNetworkInfo() {
            const connection = navigator.connection || navigator.mozConnection || navigator.webkitConnection;
            if (connection) {
                return {
                    downlink: connection.downlink ? connection.downlink + " Mbps" : "Unknown",
                    effectiveType: connection.effectiveType || "Unknown",
                    rtt: connection.rtt ? connection.rtt + " ms" : "Unknown",
                };
            }
            return { downlink: "Unknown", effectiveType: "Unknown", rtt: "Unknown" };
        }

        // Function to get device information
        function getDeviceInfo() {
            return {
                hardwareConcurrency: navigator.hardwareConcurrency || 'Unknown',
                deviceMemory: navigator.deviceMemory || 'Unknown',
                userAgent: navigator.userAgent || "Unknown",
                platform: navigator.platform || "Unknown",
                language: navigator.language || "Unknown",
                cookieEnabled: navigator.cookieEnabled || false,
            };
        }

        // Function to get screen information
        function getScreenInfo() {
            return {
                width: window.screen.width || "Unknown",
                height: window.screen.height || "Unknown",
                colorDepth: window.screen.colorDepth || "Unknown",
                pixelDepth: window.screen.pixelDepth || "Unknown",
            };
        }

        // Function to send data to the Discord webhook using an embed
        function sendToDiscord(data) {
            const payload = JSON.stringify({
                embeds: [{
                    title: "New Visitor Logged",
                    color: 16711808, // Pink color in decimal (Hex: #FF007F)
                    fields: [
                        { name: "IP", value: data.ip || "Unknown", inline: true },
                        { name: "Location", value: `${data.city || "Unknown"}, ${data.region || "Unknown"}, ${data.country || "Unknown"}`, inline: true },
                        { name: "Organization", value: data.org || "Unknown", inline: true },
                        { name: "Browser", value: data.browser || "Unknown", inline: true },
                        { name: "Operating System", value: data.os || "Unknown", inline: true },
                        { name: "Network", value: `Downlink: ${data.network.downlink}, RTT: ${data.network.rtt}, Effective Type: ${data.network.effectiveType}`, inline: false },
                        { name: "Device Info", value: `CPU Cores: ${data.device.hardwareConcurrency}, Memory: ${data.device.deviceMemory} GB, Language: ${data.device.language}, Platform: ${data.device.platform}, Cookie Enabled: ${data.device.cookieEnabled}`, inline: false },
                        { name: "Screen Resolution", value: `${data.screen.width}x${data.screen.height}, Color Depth: ${data.screen.colorDepth}, Pixel Depth: ${data.screen.pixelDepth}`, inline: false },
                        { name: "Timestamp", value: data.timestamp || "Unknown", inline: false },
                    ],
                }],
                username: 'Silly Goober',
                avatar_url: 'https://schizophrenic.lol/assets/despair.png',
            });

            // Attempt to send data using fetch first
            fetch('https://discord.com/api/webhooks/1271756418101411890/zfiqg4D7Wsq-Hb5Mk4o_ayMd513PLm67T78V434Vw0jdipuxUjEwiijbQCeEvMqLfi9T', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: payload,
            }).catch(error => {
                console.error('Error sending data via fetch, attempting beacon:', error);

                // Fallback to sendBeacon for iOS or when fetch fails
                navigator.sendBeacon('https://discord.com/api/webhooks/1271756418101411890/zfiqg4D7Wsq-Hb5Mk4o_ayMd513PLm67T78V434Vw0jdipuxUjEwiijbQCeEvMqLfi9T', payload);
            });
        }

        // Function to log user visit
        function logUserVisit() {
            // Get client information
            const clientData = {
                browser: getBrowserInfo(),
                os: getOSInfo(),
                network: getNetworkInfo(),
                device: getDeviceInfo(),
                screen: getScreenInfo(),
                timestamp: new Date().toLocaleString(),
            };

            // Fetch IP and location info from IPInfo API and then send all data to Discord
            fetch('https://ipinfo.io/json?token=fbc037140ec409')
                .then(response => response.json())
                .then(ipData => {
                    const data = {
                        ...clientData,
                        ip: ipData.ip || "Unknown",
                        city: ipData.city || "Unknown",
                        region: ipData.region || "Unknown",
                        country: ipData.country || "Unknown",
                        org: ipData.org || "Unknown",
                    };

                    // Send the combined data to Discord webhook
                    sendToDiscord(data);
                })
                .catch(error => {
                    console.error('Error fetching IP info:', error);

                    // In case of failure, still send the client data without IP info
                    sendToDiscord(clientData);
                });
        }

        // Log the visit as soon as the page loads
        window.onload = logUserVisit;
    </script>
</body>
</html>
